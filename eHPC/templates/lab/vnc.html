{% extends "base.html" %}

{% block header_ext %}
    <link href="{{ url_for('static', filename='css/lab.css') }}" rel="stylesheet">
    <script type="text/javascript" src="{{ url_for("static", filename="js/vnc/guacamole.min.js") }}"></script>
{% endblock %}

{% block content %}
    <div id="challenge-left">
        1111
    </div>

    <div id="challenge-right">
        <div id="display"></div>
    </div>
{% endblock %}

{% block footer_ext %}
    <script type="text/javascript">
        // Get display div from document
        var display = document.getElementById("display");
        // Instantiate client, using an HTTP tunnel for communications.
        var guac = new Guacamole.Client(
            new Guacamole.HTTPTunnel("http://127.0.0.1:8080/tunnel")
        );
        // Add client to display div
        display.appendChild(guac.getDisplay().getElement());
        // Error handler
        guac.onerror = function (error) {
            alert(error);
        };
        // Connect
        guac.connect();
        // Disconnect on close
        window.onunload = function () {
            guac.disconnect();
        };
        // Mouse
        var mouse = new Guacamole.Mouse(guac.getDisplay().getElement());
        mouse.onmousedown =
            mouse.onmouseup =
                mouse.onmousemove = function (mouseState) {
                    guac.sendMouseState(mouseState);
                };
        // Keyboard
        var keyboard = new Guacamole.Keyboard(document);
        keyboard.onkeydown = function (keysym) {
            guac.sendKeyEvent(1, keysym);
        };
        keyboard.onkeyup = function (keysym) {
            guac.sendKeyEvent(0, keysym);
        };
    </script>
{% endblock %}
